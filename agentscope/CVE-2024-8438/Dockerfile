FROM python:3.10

# Set working directory
WORKDIR /app

# Install dependencies
RUN apt-get update && apt-get install -y \
    git \
    && rm -rf /var/lib/apt/lists/*

# Clone the repository and checkout the specific commit
RUN git clone https://github.com/modelscope/agentscope.git \
    && cd agentscope \
    && git checkout af8e45ded37b3834c981473b309239e0102473d0

# Set the working directory inside the repo
WORKDIR /app/agentscope

# Install dependencies
RUN pip install --no-cache-dir -e .

# Expose localhost
RUN sed -i 's/127.0.0.1/0.0.0.0/g' /app/agentscope/src/agentscope/studio/_app.py

# Expose port for local access
EXPOSE 5000


# Run as_studio on container start
CMD ["as_studio"]
