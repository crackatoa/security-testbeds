# D-Tale CVE-2025-0655 Remote Code Execution

This directory contains the deployment config for D-Tale instances vulnerable and fixed to CVE-2025-0655. Instances before version 3.16.1 may allow users to potentially execute commands via Global State Override mechanism.

## How to Trigger the Vulnerability?

To trigger the vulnerability, you can use the exploit code directly with the instance ip and executed command.

Example Request:
```sh
python exploit.py http://localhost:40000 "touch /tmp/pwned"
```

In case you cannot trigger the vulnerability, you might need to delete your existing container images because Docker might try to reuse them.

```sh
sudo docker rmi -f $(sudo docker images -aq)
sudo docker remove $(sudo docker ps -a -q)
```

Sometimes the container itself returns 500 for the first HTTP request. Just refreshing the page will solve the issue. Before testing the detector or PoC, be sure that you viewed the main page from a browser or run the following curl request.

```sh
curl http://localhost:40000/
```

## Vulnerable Setup

```sh
docker build -t dtale:vuln -f Vulnerable.Dockerfile .
docker run --name dtaleVuln --network host -it dtale:vuln dtale --host localhost 
```

Application will be available at `localhost:40000`.

## Non-vulnerable Setup

```sh
docker build -t dtale:fixed -f Fixed.Dockerfile .
docker run --name dtaleFixed --network host -it dtale:fixed dtale --host localhost  
```

Application will be available at `localhost:40000`.
