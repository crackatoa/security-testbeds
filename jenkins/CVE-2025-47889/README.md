# CVE-2025-47889

In Jenkins WSO2 OAuth Plugin 1.0 and earlier, the login endpoint at http://<jenkins_ip>/login?from=/ remains accessible even when the plugin is enabled. Critically, this endpoint allows authentication with arbitrary credentials without validating them against either the WSO2 Identity Provider or the Jenkins internal user database. As a result, an attacker can gain unauthorized access by submitting any username and password combination, completely bypassing authentication controls.

## Setup

```sh
docker compose up --build
```

**Add WSO2 Certificates to Jenkins**

```sh
openssl s_client -connect localhost:9443 -showcerts </dev/null 2>/dev/null | \
awk '/-----BEGIN CERTIFICATE-----/,/-----END CERTIFICATE-----/' | \
docker exec -i --user root <jenkins_id> keytool -import -trustcacerts -noprompt \
  -alias wso2_cert -file /dev/stdin \
  -keystore /etc/ssl/certs/java/cacerts \
  -storepass changeit
docker restart <jenkins_id>
```

**WSO2**

- Login to `https://<WSO2_ip>/carbon` using `admin:admin`
- Go to: Identity → Service Providers → Add
- Service Provider Name: Jenkins
- Click Register
- Edit the new Service Provider
  - Go to Inbound Authentication Configuration → OAuth/OpenID Connect Configuration
  - Click Configure
  - Set the callback URL to `http://<ip>:8080/securityRealm/finishLogin`
  - Set the token issuer as JWT
  - In the `Claim Configuration` add a `Claim URI` containing `http://wso2.org/claims/username`

**Jenkins**

- Visit `http://<Jenkins_ip>:8080`
- Go to Manage Jenkins → Configure Global Security → Enable security
- Under Security Realm, select WSO2 Identity Server Plugin
- Set the following and then click apply
  - Service URL: `https://<ip>:9443`
  - Client ID: from WSO2 IS
  - Client Secret: from WSO2 IS
- Set the `Authorization` to `Logged-in users can do anything`

# POC

- Visit `http://<jenkins_ip>/login?from=/`
- Add random credentials
- Login

---

Refs:

- https://www.jenkins.io/security/advisory/2025-05-14/#SECURITY-3481
- https://updates.jenkins.io/download/plugins/
- https://github.com/jenkinsci/wso2id-oauth-plugin
- https://plugins.jenkins.io/wso2id-oauth/
