# CVE-2025-47889

In Jenkins WSO2 Oauth Plugin 1.0 and earlier, authentication claims are accepted without validation by the "WSO2 Oauth" security realm, allowing unauthenticated attackers to log in to controllers using this security realm using any username and any password, including usernames that do not exist.


refs:

- https://www.jenkins.io/security/advisory/2025-05-14/#SECURITY-3481
- https://updates.jenkins.io/download/plugins/
- https://github.com/jenkinsci/wso2id-oauth-plugin
- https://plugins.jenkins.io/wso2id-oauth/

the admin password is store here:

```sh
docker exec -it <container_id> cat /var/jenkins_home/secrets/initialAdminPassword
```

## setup


```sh
docker compose up --build
```

**Add WSO2 Certificates to Jenkins**

```sh
openssl s_client -connect localhost:9443 -showcerts </dev/null 2>/dev/null | awk '/-----BEGIN CERTIFICATE-----/,/-----END CERTIFICATE-----/' > wso2.crt
docker cp wso2.crt <jenkins_id>:/tmp/wso2.crt
docker exec --user root -it <jenkins_id> bash
keytool -import -trustcacerts -noprompt -alias wso2_cert -file /tmp/wso2.crt -keystore "$JAVA_HOME/lib/security/cacerts"   -storepass changeit
exit
docker restart <jenkins_id>
```


**WSO2**

- login to `https://<ip>/carbon` using `admin:admin`
- Go to: Main → Identity → Service Providers → Add
- Service Provider Name: Jenkins
- Click Register
- Edit the new Service Provider
- Go to Inbound Authentication Configuration → OAuth/OpenID Connect Configuration
- Click Configure
- Set the callback URL to `http://<ip>:8080/securityRealm/finishLogin`
- In the `Claim Configuration` add a `Claim URI` containing `http://wso2.org/claims/username`

**Jenkins**

- visit `http://<ip>:8080`
- login using admin and this password:
  ```sh
  docker exec -it <container_id> cat /var/jenkins_home/secrets/initialAdminPassword
  ```
- Go to Manage Jenkins → Configure Global Security
- Under Security Realm, select WSO2 Identity Server Plugin
- Set the following and then click apply
  - Service URL: `https://<ip>:9443`
  - Client ID: from WSO2 IS
  - Client Secret: from WSO2 IS
